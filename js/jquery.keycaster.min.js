/*
 * Keycaster v0.9alpha minified
 * By Rob Garrison (aka Mottie & Fudgey)
 * Dual licensed under the MIT and GPL licenses.
 *
 */
 
(function(d){keycaster=function(i){d("#keycaster").length||d('<ul id="keycaster"></ul>').appendTo("body");var a=d("#keycaster")[0];a.$el=d("#keycaster");a.$el.data("key",a);a.init=function(){a.options=d.extend({},keycaster.defaultOptions,i);a.keys=d.extend({},keycaster.keys,i);a.keyset=a.options.abbrevName?1:0;a.lasttext="";a.$el.hide();d(document).bind("keydown",function(b){var c=b.which;if(!(c===a.lastKey&&(c>15&&c<19||c>90&&c<94)||!a.options.showShift&&c===16)){a.lastKey=c;a.updateDisplay(b,c, false)}}).bind("mousedown",function(b){a.rotateImg(b.timeStamp,b.pageX,b.pageY)});a.options.showUnKey&&d(document).bind("keyup",function(b){var c=b.which;if(!(!a.options.showShift&&c===16))if(c>15&&c<19||c>90&&c<93){a.lastKey=null;a.updateDisplay(b,c,true)}})};a.updateDisplay=function(b,c,h){clearTimeout(a.timer);a.timer=setTimeout(a.clearDisplay,a.options.displayTime);a.$el.show();var e=typeof a.keys[c]!=="undefined",g=b.ctrlKey||b.altKey;b=b.shiftKey?String.fromCharCode(b.keyCode):String.fromCharCode(b.keyCode).toLowerCase(); var f="<"+a.options.keyWrapper+' class="keycasterKey ';f+=g||e?a.options.namedKey:a.options.regKey;f+='">';if(e){b=h?a.options.unMessage:"";b+=a.keys[c][a.keyset]}f+=b+"</"+a.options.keyWrapper+">";if(!a.options.showBksp&&c===8){a.$el.find(a.options.keyWrapper+":last").remove();f=""}a.$el.find("li").length===0&&a.$el.append("<li><span></span></li>");a.$el.find("li:last > span").html(function(k,j){return j+f});if(a.$el.find("li:last > span").width()>a.$el.find("li:last").width()){a.$el.find("li:last > span").find(a.options.keyWrapper+ ":last").remove();a.$el.append("<li><span>"+f+"</span></li>")}if(c===13||c===27)a.$el.append("<li><span></span></li>");a.$el.find("li").length>a.options.lines&&a.$el.find("li:first").remove()};a.clearDisplay=function(){a.$el.find("li:first").remove();if(a.$el.find("li").length===0||a.$el.find("li").text()===""){clearTimeout(a.timer);a.$el.hide()}else a.timer=setTimeout(a.clearDisplay,a.options.displayTime)};a.rotateImg=function(b,c,h){d("#clicked"+b).length||d('<div class="clickedArea" id="clicked'+ b+'" data-num="0"></div>').css({background:"transparent url("+a.options.imgUrl+") no-repeat 0 0",height:a.options.imgsize,width:a.options.imgsize,position:"absolute",left:c-a.options.imgsize/2,top:h-a.options.imgsize/2}).appendTo("body");var e=d("div#clicked"+b),g=parseInt(e.attr("data-num"),10)+1;if(g<=a.options.imgFrames){e.css("background-position","-"+a.options.imgsize*g+"px 0").attr("data-num",g);setTimeout(function(){a.rotateImg(b,c,h)},a.options.imgtime)}else e.remove()};a.init()};keycaster.defaultOptions= {abbrevName:true,lines:4,displayTime:1500,showShift:false,showUnKey:false,showBksp:false,unMessage:"Un-",imgUrl:"images/click-blue.png",imgFrames:6,imgsize:150,imgtime:75,keyWrapper:"kbd",namedKey:"namedKeys",regKey:"regKeys"};keycaster.keys={8:["Backspace","\u232b"],9:["Tab","\u21b9"],12:["Numpad 5","5"],13:["Enter","\u21b5"],16:["Shift","\u21e7"],17:["Control","\u273c"],18:["Alt","\u2325"],19:["Pause","Pause"],20:["Caps Lock","\u21ea"],27:["Escape","Esc"],32:["Space","_"],33:["Page Up","PgUp"], 34:["Page Down","PgDwn"],35:["End","End"],36:["Home","Home"],37:["Left","\u2190"],38:["Up","\u2191"],39:["Right","\u2192"],40:["Down","\u2193"],44:["Print Screen","PrtScn"],45:["Insert","Ins"],46:["Delete","Del"],91:["Command (left)",navigator.appVersion.indexOf("Mac")!==-1?"\u2318":"\u2317"],92:["Command (right)",navigator.appVersion.indexOf("Mac")!==-1?"\u2318":"\u2317"],93:["Menu","\u29c9"],96:["Numpad 0","0"],97:["Numpad 1","1"],98:["Numpad 2","2"],99:["Numpad 3","3"],100:["Numpad 4","4"],101:["Numpad 5", "5"],102:["Numpad 6","6"],103:["Numpad 7","7"],104:["Numpad 8","8"],105:["Numpad 9","9"],106:["Multiply","*"],107:["Add","+"],108:["Numpad Enter","\u21b5"],109:["Subtract","-"],110:["Numpad Decimal","."],111:["Divide","/"],112:["Help","F1"],113:["F2","F2"],114:["F3","F3"],115:["F4","F4"],116:["Reload","F5"],117:["F6","F6"],118:["F7","F7"],119:["F8","F8"],120:["F9","F9"],121:["F10","F10"],122:["Full Screen","F11"],123:["F12","F12"],144:["Num Lock","NmLk"],145:["Scroll Lock","ScrLk"],186:[";",";"], 187:["=","="],188:["Comma",","],189:["-","-"],190:["Period","."],191:["/","/"],192:["`","`"],193:["~","~"],219:["[","["],220:["\\","\\"],221:["]","]"],222:["'","'"]}})(jQuery);
